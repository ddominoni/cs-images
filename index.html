<!DOCTYPE html>
<html lang="pt-BR">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Galeria de Projetos</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			background: #f4f4f4;
			margin: 20px;
		}

		h2 {
			margin-top: 40px;
		}

		.carousel-container {
			position: relative;
			margin-bottom: 40px;
		}

		.carousel {
			display: grid;
			grid-auto-flow: column;
			gap: 15px;
			overflow-x: auto;
			padding: 10px 0 30px; /* espaço pros indicadores */
			scroll-behavior: smooth;
			scroll-snap-type: x mandatory;
		}

		.thumb {
			flex: none;
			aspect-ratio: 1 / 1;
			border-radius: 8px;
			overflow: hidden;
			box-shadow: 0 2px 6px rgba(0,0,0,0.2);
			scroll-snap-align: start;
			cursor: pointer;
			transition: transform 0.3s;
		}

		.thumb:hover {
			transform: scale(1.05);
		}

		.thumb img {
			width: 100%;
			height: 100%;
			object-fit: cover;
		}

		/* Responsividade: controla quantos itens cabem por tela */
		@media (min-width: 1024px) {
			.carousel {
				grid-auto-columns: calc((100% - 4 * 15px) / 5);
			}
		}

		@media (min-width: 768px) and (max-width: 1023px) {
			.carousel {
				grid-auto-columns: calc((100% - 2 * 15px) / 3);
			}
		}

		@media (max-width: 767px) {
			.carousel {
				grid-auto-columns: calc((100% - 1 * 15px) / 2);
			}
		}

		/* Botões */
		.carousel-button {
			position: absolute;
			top: 40%;
			transform: translateY(-50%);
			background: rgba(255,255,255,0.9);
			border: none;
			border-radius: 50%;
			width: 40px;
			height: 40px;
			cursor: pointer;
			font-size: 20px;
			box-shadow: 0 2px 6px rgba(0,0,0,0.2);
			z-index: 10;
		}

		.carousel-button:hover {
			background: white;
		}

		.carousel-button.prev { left: -20px; }
		.carousel-button.next { right: -20px; }

		/* Indicadores */
		.indicators {
			display: flex;
			justify-content: center;
			gap: 8px;
			margin-top: -25px;
		}

		.indicator {
			width: 10px;
			height: 10px;
			background: #ccc;
			border-radius: 50%;
			transition: background 0.3s;
		}

		.indicator.active {
			background: #333;
		}

		/* Modal */
		.modal {
			display: none;
			position: fixed;
			z-index: 999;
			inset: 0;
			background: rgba(0, 0, 0, 0.8);
			justify-content: center;
			align-items: center;
		}

		.modal img {
			max-width: 90%;
			max-height: 90%;
			border-radius: 0px;
			background-color: white;
    		padding: 10px;
		}

		.modal.active {
			display: flex;
		}
	</style>
</head>
<body>
	<h1>Galeria de Projetos</h1>

	<div id="gallery"></div>

	<!-- Modal -->
	<div class="modal" id="modal">
		<img id="modal-img" src="" alt="">
	</div>

	<!-- Toast -->
	<div id="toast" style="
	position: fixed;
	bottom: 20px;
	left: 50%;
	transform: translateX(-50%);
	background: #333;
	color: white;
	padding: 10px 20px;
	border-radius: 5px;
	opacity: 0;
	transition: opacity 0.3s;
	z-index: 2000;
	">Copiado para o clipboard!</div>

	<script>
		async function loadGallery() {
			const response = await fetch("images.json");
			const data = await response.json();
			const gallery = document.getElementById("gallery");

			Object.entries(data).forEach(([project, images]) => {
				// Container
				const container = document.createElement("div");
				container.className = "carousel-container";

				// Título
				const title = document.createElement("h2");
				title.textContent = project;
				container.appendChild(title);

				// Botão prev
				const prevBtn = document.createElement("button");
				prevBtn.className = "carousel-button prev";
				prevBtn.textContent = "←";

				// Carrossel
				const carousel = document.createElement("div");
				carousel.className = "carousel";

				images.forEach(src => {
					const thumb = document.createElement("div");
					thumb.className = "thumb";
					const img = document.createElement("img");
					const fullpath = "images/" + project + "/" + src
					img.src = fullpath;
					thumb.appendChild(img);
					carousel.appendChild(thumb);

					// Modal ao clicar
					img.addEventListener("click", () => {
						document.getElementById("modal-img").src = fullpath;
						document.getElementById("modal").classList.add("active");
					});
				});

				// Botão next
				const nextBtn = document.createElement("button");
				nextBtn.className = "carousel-button next";
				nextBtn.textContent = "→";

				// Indicadores
				const indicators = document.createElement("div");
				indicators.className = "indicators";
				const indicatorCount = Math.ceil(images.length / visibleItems());
				for (let i = 0; i < indicatorCount; i++) {
					const dot = document.createElement("div");
					dot.className = "indicator" + (i === 0 ? " active" : "");
					indicators.appendChild(dot);
				}

				// Navegação
				prevBtn.addEventListener("click", () => {
					carousel.scrollBy({ left: -carousel.offsetWidth, behavior: "smooth" });
				});
				nextBtn.addEventListener("click", () => {
					carousel.scrollBy({ left: carousel.offsetWidth, behavior: "smooth" });
				});

				// Atualiza indicadores ao rolar
				carousel.addEventListener("scroll", () => {
					const index = Math.round(carousel.scrollLeft / carousel.offsetWidth);
					[...indicators.children].forEach((dot, i) => {
						dot.classList.toggle("active", i === index);
					});
				});

				// Monta DOM
				container.appendChild(prevBtn);
				container.appendChild(carousel);
				container.appendChild(nextBtn);
				container.appendChild(indicators);
				gallery.appendChild(container);
			});
		}

		// Retorna quantos itens cabem na tela
		function visibleItems() {
			if (window.innerWidth >= 1024) return 5;
			if (window.innerWidth >= 768) return 3;
			return 2;
		}

		// Fecha modal
		document.getElementById("modal").addEventListener("click", () => {
			document.getElementById("modal").classList.remove("active");
		});

		loadGallery();

		const modal = document.getElementById("modal");
		const modalImg = document.getElementById("modal-img");
		const toast = document.getElementById("toast");

		async function showToast(message) {
			toast.textContent = message;
			toast.style.opacity = "1";
			setTimeout(() => {
				toast.style.opacity = "0";
			}, 2000);
		}

		async function copyToClipboard(text) {
			try {
				await navigator.clipboard.writeText(text);
				showToast("Copiado para o clipboard!");
			} catch (err) {
				showToast("Erro ao copiar!");
			}
		}

		document.querySelectorAll(".thumb img").forEach(img => {
			img.addEventListener("click", () => {
				// Abrir modal
				modalImg.src = img.src;
				modal.classList.add("active");

				// Copiar URL completa
				const fullUrl = window.location.origin + "/" + img.src.replace(/^\//, '');
				copyToClipboard(fullUrl);
			});
		});
	</script>
</body>
</html>